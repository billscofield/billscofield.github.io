---
layout: post
---

# VI
## 前言
* 主旋律 && 和弦
* TUI 文本用户界面

## VIM 解决问题的方式
* **执行，重复，回退**(能够重复就别用次数,只在必要时使用次数)

* 把撤销单元 切成块

* VIM 可以录制任意数目的按键操作

* 基本按键
    * d
    * c[l,aw,ap]
    * C -> c$
    
    * y

    * x
    * s -> cl
    * S -> ^C -> ^c$

    * I -> ^i
    * A -> $a
    * o -> A Cr
    * O -> ko -> k A Cr

    * it(visually select inside the tag)

    * dh
    * dl

    * iw
    * ip 
    * aw
    * ap

* 查找
    * f[char] F[char]       ;       ,
    * t[char] T[char]       ;       ,
    * /pattern  ?pattern    n       N
    * \*                    n       N

* 大小写转换
    * g~
    * gu
    * gU

* 缩进
    * >
    * <

* 使用外部程序
    * !

## 普通模式
自然放松的状态,画家停顿时移开画笔

普通模式强大的原因:把**操作符** 和 **动作命令** 结合在了一起

* 把撤销单元切成块,使修改可重复
    从进入插入模式起到返回普通模式为止，在此期间输入或删除的任何内容都被当成一次修改。因此，只需控制ESC键的使用。

* 加减运算
    * Ctrl a
    * Ctrl x
    * set noformats=    把所有数字当做十进制

* 撤销
    * u

* 重做
    * ctrl-r (redo)
        * 插入模式下是访问寄存器

* 当一个操作符命令被连续调用两次时，它会作用于当前行。

* 命名空间
    * 很多命令都由两个或更多的按键来调用（:h g, :h z, :h ctrl-w, :h [),但在多数情况下，头一个按键只是第二个按键的前缀。这些命令不会激活操作符待决模式，相反，可以把它们当成命名空间，用来扩充可用命令的数目。

    * 命名空间命令 仅仅是普通模式的一个扩充

* 操作符待决模式
    * **只有操作符才会激活操作符待决模式**

* 命令
    * 重绘屏幕
        * z Enter
        * z.
        * z _

## 插入模式
* 在插入模式中更正错误
    * ctrl-h
    * ctrl-w
    * ctrl-u

* 返回普通模式
    * Esc
    * ctrl-[
    * **ctrl-o    切换到 插入-普通 模式**
        * ctrl-o zz
* ctrl-r-=
    随时随地做运算

## 可视模式
* 面向的对象
    * 字符文本
        * v
    * 行文本
        * V
    * 块文本
        * ctrl-v

* 切换选区的活动端
    * 一端固定，一端移动 
    * o

* **重选上次的高亮选区**
        * gv

* 可视模式间切换
    1. 相应的可视模式按键
    1. Esc or ctrl-[ 

* . 只有在面向行的选取时，才特别有用。

* **普通模式 是先操作，再选取；可视模式相反，符合大多数编辑器的认知，即先选取，再操作。**

* 每次在可是模式中移动光标，都会改变高亮选区的边界。

* **选择模式：输入的可见字符会使所选中的文本被删除。Vim的可视模式未遵从此惯例。**
    * ctrl-g 可以进入 典型的 选择模式，唯一地不同 底部显示：--visual--  or  --select--


* 当一条可视模式命令被重复执行时，它会影响相同数量的文本。

* 如果我们想使点命令能够重复某些有用的工作，那么最好要远离可视模式。

* 对一次性的修改来说，可视模式完全够用

* 修改列文本
    * 删除操作会同时影响所有被选中的行
    * 插入操作只影响顶行，返回普通模式后，才会影响选区

* **在可视模式 及 操作符待决模式 中，i 和 a 键沿用一个不同的约定。它们会被当做一个文本对象的组成部分。**

* 使用 I 和 A

## 命令行模式

* :=
    * 计算文件有多少行

## 管理多个文件
* 缓冲区列表记录了一次编辑会话中打开的所有文件。

* 参数列表式缓冲列表的强力补充。

* 我们编辑的只是文件在内存中的映像，也就是 Vim 术语中的“缓冲区”

* 文件是磁盘上的，而缓冲区存在于是内存中。

### 命令
    * :ls   列出所有被载入到内存中的缓冲区的列表
        * % 指明哪个缓冲区在当前窗口中可见
        * # 代表轮换文件
            * ctrl-^ 在当前文件和轮换文件之间快速切换
    * :bnext
    * :bprev
    * :bfirst
    * :blast
    * :b [number] 或 :b[number] 或 :b [唯一标识此缓冲区的字符]

    * 删除缓冲区
        * :bdelete [标识符] 
        * :bdelete [数字]
        * :范围bd

### 参数列表
    * :args
    * 参数列表是 Vi 的一个功能，而缓冲区列表是 Vim 引入的增强功能???

    * 填充参数列表
        * 最简单的方式 是 逐一指定文件的名字

缓冲区列表 和 参数列表 有什么区别呢？？？

### 将工作区切分成窗口
* ctrl-w-s 水平切割，新窗口在上
    * :edit 使新窗口成为活动窗口
    * :edit [newfile],在新窗口打开新的缓冲区
* ctrl-w-v 垂直切割，新窗口在左
    * :edit 使新窗口成为活动窗口
    * :edit [newfile],在新窗口打开新的缓冲区
* :split 
    * 空 在新窗口中打开当前缓冲区
    * [filename] 水平切分当前窗口，并在新窗口中载入file
* :vsplit 
    * 空 在新窗口中打开当前缓冲区
    * [filename] 垂直切分当前窗口，并在新窗口中载入file

### 在窗口间切换
    * ctrl-w-w
        * 循环切换
    * ctrl-w-h
    * ctrl-w-j
    * ctrl-w-k
    * ctrl-w-l

### 关闭窗口
    * :clo[se]  或 Ctrl-w-c 关闭活动窗口
    * :on[ly]   或 ctrl-w-o 只保留活动窗口，关闭其他所有窗口

### 改变窗口大小及重新排列窗口
    * ctrl-w-=    所有窗口等宽，等高
    * ctrl-w-_    最大化活动窗口的高度
    * ctrl-w-|    最大化活动窗口的宽度
    * [n]ctrl-w-_ 活动窗口高度设为n
    * [n]ctrl-w-| 活动窗口宽度设为n
    * [n] ctrl-w +  高度加n
    * [n] ctrl-w -  高度减n

* 用标签页将窗口分组
    * 标签页是容纳一系列窗口的容器，类似于浏览器,更像是 Linux 中的虚拟桌面

    * 打开标签页
        * :tabedit [tabname]
        * :tabedit 没有名字
    * 关闭
        * :tabc[lose]   关闭当前标签页及其中的所有窗口
        * :tabo[nly]    只保留活动标签页，关闭所有其他标签页
    * 切换
        * :tabnext [n]     [n]gt    切换到编号为 n 的标签页
        * :tabnext         gt       下一个标签页
        * :tabprevious     gT       上一个标签页
    * 移动
        * :tabmove [n]     [n] 为第几个，第一个为 0 ，省略n,为移动到最后

    * 如果当前标签页中包含了不止一个窗口，可以用 ctrl-w-T 将当前窗口移到一个新标签页中

## 打开及保存文件
* :pwd  当前工作目录

* 相对于当前工作目录打开一个文件

* 相对于活动文件目录打开一个文件
    * 缓冲区做参考点
    * % 代表缓冲区的完整文件路径
        * :edit %<tab>
            * tab 键会将当前文件的文件文件名展开
        * :edit %:h<tab>     或者    :edit ./
            * 当前文件所在目录的路径
            * :h 会去除文件名，保留路径中的其他部分
## 帮助
* :h vimtutor

## Ex命令
* % 代表本文件
* 


* :read

    :read ! wc %

    * read 命令会把外部命令的输出作为新的一行插入到编辑的文件中的当前行的下面一行。如果你愿意，你也可以指定一个特定的行号——输出将会添加到特定行之后。

    例如，下面的命令将会在文件的第二行之后添加 wc 的输出。

    :2read ! wc %

    注意： 使用 $ 在最后一行插入， 0 在第一行前面插入。
* 


## 管理多个文件

### 缓冲区列表
* 增
    * 在 Vim 没有关闭的情况下，打开的文件、标签页
* 删
    * :bdelete [number1] [number2] ...
    * :bdelete [唯一标识1] [唯一标识2]
    * :s,ebd
* 改
    * :bnext
    * :bprevious
    * :bfirst
    * :blast
    * :buffer [number]
    * :buffer [唯一标识]
* 查
    * :ls
* 零碎
    * % 哪个缓冲区在当前窗口可见
    * # 轮换文件
    * **ctrl-^ 当前文件和轮换文件快速切换**
    * a 活动缓冲区
    * h 隐藏缓冲区
* **在退出时，处理隐藏缓冲区的方式**
    * :w[rite]      把缓冲区内容写入磁盘
    * :e[dit]!      把磁盘文件内容读入缓冲区（即回滚所做修改）
    * :qa[ll]!      关闭所有窗口，摒弃修改而无需警告
    * :wa[ll]!      把所有改变的缓冲区写入磁盘


### 参数列表
* 增
    * :args {arglist}
    * \* 不递归
    * \*\* 递归
    * **用反引号 ` 指定文件**
        * :args `cat .category`

### 多窗口
* 增
    * 水平  ctrl-w-s    :split [file]
    * 垂直  ctrl-w-v    :vsplit [file]
* 删
    * :close
    * :only
* 改
    * ctrl-w-w  在窗口间循环切换
    * ctrl-w-h
    * ctrl-w-j
    * ctrl-w-k
    * ctrl-w-l

    * c-w-=     所有窗口等宽、等高
    * c-w-\_     当前窗口高度最大化
    * c-w-|     当前窗口宽度最大化
    * [n]c-w-\_  高度设为 n 行
    * [n]c-w-|  宽度设为 n 列
    * [n]c-w-+  高度加 n
    * [n]c-w--  高度减 n

### 标签页
* 增
    * tabedit [filename]
    * 把当前窗口移到一个新标签页    c-w-T
* 删
    * :tabclose
    * :tabonly
* 改
    * tabnext [n]       [n]gt
    * tabnext           gt
    * tabprevious       gT
    
    * tabmove [n]
        * n为0 ，移动到最前面
        * n为空，移动到最后面


## 文本对象
文本对象由两个字符组成，第一个字符永远是 i 或 a
